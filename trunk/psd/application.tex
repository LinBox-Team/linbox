\section {Application to Lie matrices}
The matrices from Lie group representation are rational matrices,
our algorithms in the previous section focus on integer matrices.
There are at least two alternative way to adapt.
One is to compute the minimal polynomial, or the leading principal minors
over the rationals.
The rational answers need to be reconstructed at the GenCRA,
and it is easy to adopt our GenCRA with early termination technique to
this case.
The other way is to multiply the matrices by the $\lcm$ of
denominators of all entries.
For these special constructed matrices from Lie group representation, 
the $\lcm$ of denominators of all entries
is just a little larger than each individual one,
so the latter is a better way. 
We found for some models the $\gcd$ of all the
numerators of the dense representation are not trivial,
so it could be removed.
Here, we present blackbox algorithms to compute the
$\lcm$ of denominators of all entries, 
and $\gcd$ of numerators of all entries,
respectively.
\begin{algorithm} {LDE}
\Inspec \\
$A$, a rational matrix\\
$M$, sample size\\
$n$, number of trials
\Outspec \\
$d$, the $\lcm$ of denominators of all entries of dense representation of $A$.
\Stmt[1.]
for $i$ from $1$ to $n$ do\\
Choose a random vector $x^{(i)}$ with entries independently and uniformly chosen
from $[0, M]$\\
$y^{(i)} = A x^{(i)}$, apply $x^{(i)}$ to $A$\\
$d^{(i)}$= the $\lcm$ of denominators of every entry of $y^{(i)}$.
\Stmt[2.]
$d := \lcm (d^{(1)}, \cdots, d^{(i)})$
\Stmt[3.]
return $d$.
\end{algorithm}

\begin{algorithm}{GNE}
\Inspec \\
$A$, an integer matrix\\
$M$, sample size\\
$n$, number of trials
\Outspec \\
$g$, the $\gcd$ of all entries of dense representation of $A$.
\Procspec\\
Apply algorithm {\em LDE} by replacing $\lcm$ with $\gcd$ and 
denominators with numerators.
\end{algorithm}
%\Stmt[1.]
%$g := 0$
%\Stmt[2.]
%for $i$ from $1$ to $n$ do \\
%Choose a random vector $x$ with entries independently and uniformly chosen
%from $[0, M-1]$ \\
%$y := A x$, apply $x$ to $A$\\
%$g^{(i)} :=$ $\gcd$ of all components of $y$\\
%$g := \gcd (g, g^{(i)})$
%\Stmt[3.] return $g$.
%\end{algorithm}
%%
The algorithm {\em LDE}
always returns a factor of the true answer.
The algorithm {\em GNE}
always returns a multiple of the true answer.
For both algorithms, for a rational matrix $A$, if 
$d$ and $g$ are the $\lcm$ of all denominators 
and $\gcd$ all numerators of entries of $A$, respectively.
If let $A^\prime = \frac{d}{g}A$, then $A^\prime$ is an integer matrix.
For each individual trial,
if all entries of  $A^\prime x^{(i)}$ are coprime,
then $d^{(i)}$ is equal to the correct answer in both algorithms.
Please see \cite{Saunders::LA::2004} for probability analysis. %%fix me
In both cases, the error probability is 
$2^{-n + 1}$, roughly speaking.

%Each matrices from Lie group representation for E8 can be represented as
%$(\prod_{1 \leq i \leq 120} \frac{1}{r_i}(r_i Ops^{(i)} + I)) F$,
%where $Ops^{(i)}$ is one of the eight sparse matrices called operators, 
%$F$ is also
%sparse matrix. 
Each matrix $J_\rho(\n)$ can be representat as
$\prod (\frac1{r_i}(r_iT_i +I))J_\rho$, where $T_i=\rho(s_{\alpha_i})$
as in Section 2, and $T_i$ and $J_\rho$ are sparse matrices.
The algorithm BBSM is very suitable for this case, and
we also reduce product of original $121$ sparse matrices 
to product of $94$ ones for the $E8$ case.
explicitly computing and storing $r_i T_i + I$ as a sparse matrix, 
and multiplying it to left one if the computed sparse matrix is a
diagonal matrix. By reducing number of sparse matrices, 
$20\%$ run time was saved for BBSM algorithm. 
After multiplying these collapsed matrices 
by the $\lcm$ of denominators of all entries and dividing
by $\gcd$ of numerators of all entries, these matrices can be handled by these
algorithms discussed in previous section.


