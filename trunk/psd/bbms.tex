\subsection{Signature algorithm for blackbox matrix}
In this subsection we assume the $n\times n$ matrix $A$ in question is a 
blackbox for a symmetric matrix.  
For instance it could be the Lie group element, 
product of 121 very sparse matrices, discussed above.  
More specifically, assume the blackbox matrix vector product is implemented 
using $E$ axpy calls, where $0 \leq E \leq n^2$.

\begin{algorithm}{BBMS $[$ (via BlackBox Minpoly) Signature $]$}
\Inspec $A$, an integer or rational blackbox symmetric matrix.
\Outspec Signature $s = [\#p, \#z, \#n]$ of $A$.
\Stmt[1.] $[$ Initial data $]$\\
Let $A_p := A$ mod a random prime $p.$\\ 
$[$ This construction works even if $A$ is a rational matrix, provided $p$ does 
not divide any denominator of $A$.$]$\\
Let $r := \rank(A_p).$\\
Let $m_p(x) := \minpoly(A_p)$, over GF(p).\\ 
\Stmt[2.] $[$ Preconditioning may be necessary $]$\\
If $\deg(m_p) \leq r < \order(A)$, let $B := DAD$, for random integer matrix $D$ with entries chosen from
range $1..s$. $[$ Or any set of $s$ nonzero values.$]$\\
Otherwise, let $B := A$.\\
\Stmt[3.] $[$ now charpoly is minpoly $]$\\
Let $m(x) := \minpoly(B)$. \\
\Stmt[4.] $[$ certify $]$\\
If $\coeff(m, \deg(m)-1) \neq \trace(B)$, Return ``fail".\\
Return PolynomialSignature($p$).
\end{algorithm}

\begin{theorem}
Algorithm BBMS is a LasVegas probabilistic algorithm.
For an integer blackbox symmetric matrix, $A$,  
of order $n$, whose entries (when constructed) are of length bounded by $d$,
it runs in expected time 
$\softO(n^2 E d)$.
In particular if $E \in \softO(n)$, and $d \in \bO(\log(n))$,
then the expected run time is $\softO(n^3)$.
\end{theorem}

Proof:
The computation of $A_p$ costs at most $\softO(dE)$, since the number of stored data values
needed is at most $E$, each of length bounded by $d$.  The rank and minpoly of $A_p$ cost at most $\softO(nE)$, \cite{SSV04}, asssuming a prime of length O($nd$).  

If this rank is correct, the algorithm will be correct.  If it is not,
that fact will be caught by the certification in step 3.  The probability
of error for this rank is 

Step 2 costs at most the insignificant (linear) time for the construction of $D$.  
The major cost is the $m = \minpoly(B)$ over the integers in step 3.
We assume here that integer matrix minpoly will be computed (MonteCarlo)
by a choosing a series of random primes $p$, computing the minpoly mod
these primes, and finally combining results by computing the coefficients
over the integers using the Chinese Remainder Algorithm.  The number
of primes needed according to Hadamard's bound is $\softO(n d))$.
Since the cost of a minpoly mod each prime is $\softO(nE)$, the cost of this
step is $\softO(n^2 E d)$.
In practice we use an early termination policy, terminating the series 
of modular computations when the last prime fails to cause any change in 
the residues mod the product of the primes.
The check in step 3 is essentially the rank certificate of \cite{SSV04}.
\QED

If the matrix is of rational numbers, the method may still be used.  However
the probability bounds are much poorer... fixme.


